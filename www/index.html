<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" charset="utf-8" src="js/cordova-1.7.0rc1.js"></script>
<!--    <script type="text/javascript" charset="utf-8" src="cordova-1.7.0rc1.js"></script> -->

    <script type="text/javascript" charset="utf-8" src="js/cloudmine.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/users.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
    <script src="cdv-plugin-fb-connect.js"></script>
    <script src="facebook_js_sdk.js"></script>

    <script>
      var users;
      $(function() {
        users = new Users();
      });
      document.addEventListener('deviceready', function() {
        FB.init({
          appId: "360447590670196",
          nativeInterface: CDV.FB,
          useCachedDialogs: false
        });

        checkLogin();
      }, false);

      function checkLogin() {
        FB.getLoginStatus(function(response) {
          console.error(response);
          if (response.status == 'connected') {

            console.log('redirect feed.html')
            window.location = 'feed.html';
          } else {
            alert('not logged in');
          }
        });
      }
      FB.Event.subscribe('auth.login', function(response) {
        console.error("DEBUG: event login response" +  JSON.stringify(response));
        // users.createUser
        window.location = 'feed.html'
      });

      function login() {
        FB.login(function(response) {
          console.error("DEBUG:login response" +  JSON.stringify(response));
          // if (response.session) window.location = 'feed.html'
          // else alert('not logged in');
        }, { scope: "email" });
      }

    </script>
  </head>
  <body>
    <a href="#" onclick="login();">LOGIN</a>
  </body>
</html>